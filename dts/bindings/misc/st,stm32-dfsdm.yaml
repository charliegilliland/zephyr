# Copyright (c) 2024 Charlie Gilliland
# SPDX-License-Identifier: Apache-2.0

description: "STM32 DFSDM"

compatible: "st,stm32-dfsdm"

include: base.yaml
#include: [base.yaml, reset-device.yaml]

dfsdm-config-cells:
  - chan
  - filt

properties:
  "#address-cells":
    required: true
    const: 1

  "#size-cells":
    required: true
    const: 0

  reg:
    required: true

  clocks:
    required: true

#  "#dfsdm-config-cells":
#    type: int
#    required: true
#    const: 2


#  resets:
#    required: true

#  interrupts:
#    required: true
  
#  interrupt-names:
#    required: true

#  audio-clock:
#    required: true

child-binding:
  description: |
    STM32 DFSDM channel configuration.

  include: [base.yaml]

  compatible: "st,dfsdm-chan"

  properties:
    output-clk-en:
      type: bool

    sample-edge:
      type: string
      default: "rising"
      enum:
        - "rising"
        - "falling"

child-binding:
  description: |
    STM32 DFSDM filter configuration.
  
  include: base.yaml

  compatible: "st,dfsdm-filt"

  properties:
    dmas:
      required: true
    
    # TODO: right shift...